<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Aspen editor</title>
		<link rel="stylesheet" href="lib/codemirror.css">
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
		<script>window.jQuery || document.write('<script src="lib/jquery-1.9.0.min.js"><\/script>')</script>
		<script src="lib/codemirror.js"></script>
		<script src="addon/edit/matchbrackets.js"></script>
		<script src="mode/clike/clike.js"></script>
		<link rel="stylesheet" href="doc/docs.css">
		<style>.CodeMirror {border: 2px inset #dee;}</style>
		<script>
			$(function() {
				var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
					lineNumbers: true,
					matchBrackets: true,
					mode: "text/x-konoha",
					konohaurl: "aspen/index.cgi"
				});
				$("#run").click(function() {
					editor.run(function(text) {
						var doc;
						if(document.all) {
							doc = document.getElementById("result-iframe").contentWindow.document;
						}
						else {
							doc = document.getElementById("result-iframe").contentDocument;
						}
						doc.writeln("<body></body>");
						doc.body.innerHTML = "";
						doc.writeln("<script>function p(text){document.body.innerHTML += text + '<br>'}");
						doc.writeln(text + "<" + "/script>");
					});
				});
			});
		</script>
	</head>
	<body>
		<h1>Aspen editor</h1>

		<form action="#"><textarea id="code" name="code">
/* Konoha demo code */
int fib(int n) {
	if(n < 3) {
		return 1;
	}
	return fib(n - 1) + fib(n - 2);
}
System.p(fib(30));
</textarea></form>
		<button id="run">run</button>
		<iframe id="result-iframe"></iframe>
	</body>
</html>
